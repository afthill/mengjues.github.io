title: "通向机器学习之路的简单实用指南（一）：背景知识、基础概念和工作流"
date: 2016-09-23 10:09:38
tags:
- Translation
- Recommend
categories:
- 机器学习
---

原文[链接](https://indico.io/blog/simple-practical-path-to-machine-learning-capability-part1/)，作者：Dan Kuster

翻译者：[马峰](http://m.imf.cc/)，本文禁止全文转载

Hello，亲爱的人类！非常欢迎你们来到这一系列关于如何使用机器学习去解决问题的文章。通常我们会以基础的概念为起点，然后在后面会有一些列Python和
TensorFlow的代码来实现。然后我们将进一步展示如何合并利用和拓展这些基本的概念去解决更有趣的问题。

### 一种效率不高的学习方式

现在我们可以很容易在tensorfolow的官方网站或者其他地方找到[教程](https://github.com/nlintz/TensorFlow-Tutorials)，比如（[1](https://www.tensorflow.org/versions/r0.10/tutorials/index.html)、
[2](https://github.com/nlintz/TensorFlow-Tutorials)、[3](https://github.com/aymericdamien/TensorFlow-Examples)、[4](https://github.com/pkmital/tensorflow_tutorials)、[5](https://cs224d.stanford.edu/lectures/CS224d-Lecture7.pdf)）。
但是我们也发现许多很聪明的人，在学习tensorflow的时候，也会在第一次就深深跌入机器学习的代码实现中。这会导致你一个通用的效率不高的模式，你认为你
在学习的时候，停滞在实现的细节里，而实际上你只是停滞在思考的流程里：

- 搜索一些tensorflow的教程，然后放进浏览器里
- 然后开始循着一个简单的教程，很快学完后，觉得好棒，很容易就实现了教程里的功能，而且使用的是DNN（deep neural networks）
- 然后尝试着使用一些非常[复杂](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/seq2seq.py#L745)的模型去解决新问题
- 嗯，出现了一些错误导致不能工作，而且看起来这个错误不容易被解决
- 再次去网上搜索寻找答案，也许别人已经解决了我的这类问题

--------------------------------------------

![](https://indico.io/blog/wp-content/uploads/2016/08/frustrated.gif)

### 更清晰的思考到写代码的过程 

如果这里有像一个专家一样使用机器学习的秘密，我想这个秘密应该是这样：机器学习的核心不是去写代码，而是一种科学思考的流程：首先把你遇到的唯一的问题翻译成机器学习的任务（Task），这个任务然后通过数据、机器学习的思想、工具（比如tensorflow）、互联网上的信息等被解决。我们现在就开始吧！

### 范围（scope）

这篇文章引入了一些列通用的关于机器学习的基础概念，这些概念可以帮助理解在机器学习中的大部分的解决问题的方案。我们在这里并不会展示大量通用的机器学习的理论，只是一系列可以帮助你大量提高机器学习能力的范式。这些范式是许多模型的基础，包括从最简单的线性回归到深度神经网络。

现在我们开始介绍一些简单的、基础的在机器学习中实用的概念，我们将会展示在机器学习的思考流程中与我们常见的科学的思考流程是多么的相似。在本系列文章的第二部分，我们还将把这些思考的流程放进一个非常的简单的机器学习的模型中，去解决一些光学识别（OCR）的任务。后面的文章，我们还将基于这些已经学习的概念，实现一个基本的神经网络去解释在1990到2000时代的对于机器的改进，导致可以训练深度神经网络成为可能，深度神经网络的成功也是机器学习在今天变得流行的重要原因。

#### 为什么我应该阅读

- 你已经拥有了良好的python编程能力，你喜欢去学习一些教程并且亲自去验证教程里的每一个步骤。你已经理解了机器学习的基本的知识--通过训练一个机器去做事情，通过数据而不是程序逻辑使机器可以自主工作。这就是在你学习本系列教程之前唯一需要知道的东西。如果你不懂python编程，不要欺骗你自己，从来没有机器可以在没有学会工具的前提下可以变得可以使用而且功能强大，如果你真的有兴趣去学习机器学习，应该用一个正确的方法。

- “请帮忙！我已经搜索了几篇TensorFlow Tutorials并且发现了很多页的结果，应该从哪一个开始学起来？”学习的最好的方式是去实现你学到的东西，通过实验和练习去满足你的好奇心。不幸的是，大部分的教程都有作者自己学习过程的边际效应，并没有基于你当前的知识储备进行优化。我们正在写的这一系列教程，就是为了让读者可以首先理解机器学习的概念，并且可以通过tensorflow如何简单地实现这些概念。

- “我已经看到google正通过sampled softmax和bucketing在使用双向的LSTM sequence to sequence神经翻译模型在他们的seq2seq模型中。听起来让人印象非常深刻，我应该从这里开始学习！”哈哈，这也是我开始学习tensorflow的起点。你比我更聪明。即时已经拥有了良好的机器学习的知识，能够快速通过同事或者社区找到帮助，并且通晓各种训练集，但是从更简单的开始通常是一个更好的主意。

- 你已经阅读了大量的教程，但是你依然挣扎于把这些概念应用到实际的场景中去解决问题。这依然是你因为开始就阅读比较复杂的实例带来的毛病，解决的方法就是从最基础的概念开始。

#### 哪些人不需要阅读（或者你阅读后会觉得不是你想要的）

- 博士生。如果你已经是一个机器学习的研究者，并且拥有了良好的机器学习的基础知识和概念，你已经非常熟悉Torch和Thenao，你可以直接阅读Alec和Nathan的仓库：
    - 原初的关于机器学习的基础概念，编程语言是Theano，Alec为它在Tufts大学的讲座建立了一个仓库：
        - https://github.com/Newmu/Theano-Tutorials
        - https://www.youtube.com/watch?v=S75EdAcXHKk
    - Nathan写的关于tensorflow的文章，包括一些高级模块比如autoencoder、LSTM：
        - https://github.com/nlintz/TensorFlow-Tutorials

- 机器学习黑客。希望你已经知道了大部分这里的知识。但是有时去温习一下也是不错，温故而知新嘛。

- 统计学家。如果你期待某种程度上的统计学上的严谨可以在这里讨论，我将会说对不起，这不会发生。没有人可以理解：为什么某些机器学习方法比如神经网络可以工作的这么好。就如也没有人知道统计学和数学为什么可以在一起工作的很好一样。

- 真正的初学者。如果你想学一些更多的关于机器学习的方法和概念，而不是想学习一些快速的、实用的这些教程，你可以尝试Vincent Vanhoucke的[相关课程](https://www.udacity.com/course/deep-learning--ud730)。那个课程很棒，老师是tensorflow的一个技术领导。

#### 为什么没有设立一个仓库

因为我们程序员总是很懒，当我们被强迫去探索和有点挣扎的时候，学习才会真正的沉淀下来。低效率对学习是有好处的。所有在这里的代码都是免费的和可见的，但是你必须开始学会思考并形成你自己的习惯。如果我们放一个repo，你将会直接clone它，因此使你的学习过程变得短路。除此之外，已经有了一个很好的repo，后面会提及。

#### 关于机器学习的参考书

你当然不能错过[Goodfellow, Bengio, Couville](http://www.deeplearningbook.org/)的书，在线版本也是免费的。

-----------------------

#### Setup

1. 阅读tensorflow官方[文档](https://www.tensorflow.org/)，如果你看到一个陌生的概念，需要查看相关的文档。

2. （可选的）如果你想要GPU计算，可以下载安装CUDA。

3. 使用官方文档安装tensorflow。linux推荐，macos也是可以。

4. 运行最简单的[测试](https://www.tensorflow.org/versions/r0.10/get_started/os_setup.html#test-the-tensorflow-installation)，如果你的测试没有通过，则表示你安装的tensorflow是不可以用的。如果你不能安装GPU的版本，你可以直接安装CPU的版本。

#### 什么是TensorFlow？它有什么特点？

Tensorflow是google开发的第二代的关于机器学习的系统。这里有很多原因人们需要对tensorflow欢呼。作为实用问题的解决者，我们唯一关注tensorflow的理由是，它通常使我们的实验更快。Tensorflow的下列特征使它实验时更快：

- 符号的差异化能力使我们在写python代码时可以跟数学文献上的符号比较一致，然后tensorflow可以编译成可执行的代码。研究人员实用数学符号是因为，数学符号可以帮助他们更容易思考，但是把这些数学公式转化为真实的可以执行的代码却是困难的，只有很少的数学家可以写出来具体的代码的实现。完全是不同的技能集，因此，能够同时高效地写数学公式和具体的实现对数学社区是一个巨大的时间的节省。虽然一些工具比如Theano也可以高效的实现数学公式和符号，但是tensorflow并不仅仅提供这唯一的可以使用的特点。但是正是tensorflow的流行和神经网络，导致了大量的用户真正第一次接触到数学到实现的便捷。

- 编译到CPU或者GPU。训练机器学习模型对计算资源要求是非常高的，对于tensorflow这样的工具，我们可以借助GPU的强大的并发运算能力，可以达到最大30倍的提高。如果要使用GPU，你可能需要大量的编程技巧去调用GPU的并发机制，但是tensorflow可以快速的编译到GPU后者CPU，只需要很少的代码，就可以在两个平台自由切换。因此，tensorflow拥有了一个非常强大的多GPU支持的架构。

- 限制。tensorflow实现了许多限制和抽象去帮助我们思考一个问题，并且准备数据去解决问题。这可以帮助我们在解决问题的时候借用并发、模块化的概念。限制激发你的创造力，不应该被低估。

- 模型生命周期管理。模型的生命周期管理在机器学习中是一个痛。什么时候，我们需要从一个保存的检查点中重新加载模型并重新开始训练？如何部署一个模型到远程的服务器？如何可视化一个模型以便我们可以确信我们实现的模型正是我们所需？如何加载和卸载数据流？tensorflow有一个专门的feature去处理这些问题。

- Python总是有一个强大的社区，那里的人们很快就接受了tensorflow。如果你没有有经验的同事，你可以直接去github后者stackoverflow上寻找答案。如果你在一个问题停留超过30分钟，你应该求助你的朋友，或者互联网。

### 机器学习流程的基础部分

#### 通过例子学习

机器学习的最重要的一点就是：把人从实现和发现规则（rule）中解放出来。就像人类一样，我们通过实例学习。我们通过观察实例，形成了一个关于机器如何工作的模型（或者前提），然后我们观察这个模型的效果。当某个实例出现的结果与我们的模型不一致的时候，我们更新模型去接受，以便观察到的效果与我们的模型的预测结果更加一致。我们可以记忆之前的实例，通过更加通用的模型，用来预测我们从来没有看到实例。

![](https://indico.io/blog/wp-content/uploads/2016/08/TF0-1-sm-copy.png)

跟人类的对外部的传感输入相比，计算机程序仅仅具有非常有限的方式去观测事物，但是现代化的模型或者工作流是非常类似的。机器学习也是通过实例学习，但是机器通过输入的数据流去学习知识，更新它内部的状态以便与外部的输入预期一致。一个机器模型可以记忆之前的输入，从而可以预测它之前从来没有见过的实例。

![](https://indico.io/blog/wp-content/uploads/2016/08/TF0-2-sm-copy.png)

#### 机器学习的技术优势

计算机拥有一个不可比拟的优势：速度、精度、可重复性、分享完全一样的拷贝、不会疲劳、存储、所需电力。因此，当我们尝试去优化一个学习的流程时，我们应该充分考虑这些机器所具备的优势。

比如，我们可以可以更加显式的强化评估的步骤。假如输入一个实例，模型然后会输出一个预测的结果。然后我们可以评估这个预测，然后基于这个评估进一步去更新我们的模型。

![](https://indico.io/blog/wp-content/uploads/2016/08/TF0-3-sm-copy.png)

#### 损失值是对学习的反馈

计算机很擅长于遍历一些列学习数据，但是我们怎么确信下一个遍历的更新与当前的更新是一致的。一个简单的方法是，写一个评估函数去返回这个损失值。该函数（通常被叫做损失函数或者成本函数）比较已知的答案与预测的答案，然后生成一个正态化的分数。现在我们可以应用同一个函数到每一个输入的数据，并且，我们可以把它的值正态化以便提高学习流程的动态性，通过我们这个正态化使用的是log变形。

损失函数的概念和损失值对于机器学习是非常重要的。损失值是机器学习的关键的反馈，它确立了你的机器学习的模型的优化目标。没有这个损失值，你的机器学习模型将不会知道哪个参数应该优化。这里有许多的关于损失值的计算函数，你必须基于你所面临的问题，而去选择一个最合适的。

![](https://indico.io/blog/wp-content/uploads/2016/08/TF0-4-sm-copy.png)

#### 机器学习的调优

最后一块关于机器学习的步骤是通过成本函数（cost function）去对机器学习的模型进行调优。过去的几十年，大量的聪明家伙花费大量的努力去解决优化问题：“给你一些列的损失值，什么是最佳的方法对模型进行调优？一个最好的调优器应该是获取一个输入的数据，然后可以完美地预测最好的调优参数。但是在现实世界里，调优器通常收敛参数以便保证更好的损失值--如果多轮之后，并没有很大的提高，调优器将会收敛并且终止。某些场景下，你可能希望调优器快速收敛到合适并且正确率较高的参数。但是某些场景下，你可能想要不计成本的获取最好的调优参数。调优是非常深奥和技术性的领域，我们将会在未来的文章里更深入地学习。

幸运的是，我们已经重构出去了`损失值（loss value）`，因此对于损失值的优化是在一个模块的基础上的。尤其对于像`Gradient descent`这类的一级的遍历优化者，基于模块化的优化器是当前的利用后向繁殖（back propagation）训练神经网络的最优选择。因此，从实用的角度，从一个优化器切换到另外一个优化器，跟函数名的切换一样简单。

#### 总的来说，一个非常模块化的系统

机器学习的流程是非常类似于科学的思考的流程，人类通过传感输入的数据去观察输出的结果，而机器学习则必须被喂养数据。通过对机器学习流程的调优，我们可以利用计算机的优势去获得更加有力的机器学习的流程。首先，我们重构出去了损失函数用来评估和更新模型，这让我们在定义机器学习的反馈机制时更加的系统化，它也给了我们统一的界面去尝试各种不同的损失计算的函数。最后，我们抽象化出来优化的流程，给一个评估到的损失值，然后通过损失值去更新模型的参数，以便产生更好的预测。这就是机器学习的基础部分。

#### 自我检查

我们来复习一下，请快速回答问题。

1. 什么是机器学习和人类的科学学习流程的不同？

2. 我们要使用tensorflow的原因有哪些？

3. 什么是最好的优化器？

##### 机器学习所涉及的名词

- task
- model
- encoding
- feature engineering
- inference
- decoding
- loss function


------------------------

![](https://indico.io/blog/wp-content/uploads/2016/08/dosequis.gif)